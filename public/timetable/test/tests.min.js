module("jQuery Week Calendar v2.0-dev");function formatTimeZone(){var a=-(new Date("Apr 21 2011")).getTimezoneOffset();var a={sign:(a<0?"-":"+"),hour:(Math.floor(a/60)),minute:(a%60)};return a.sign+(a.hour<10?"0":"")+a.hour+":"+(a.minute<10?"0":"")+a.minute}test("Default Options",function(){var a=$("#calendar");a.weekCalendar();expect(30);deepEqual(a.weekCalendar("option","alwaysDisplayTimeMinutes"),true);deepEqual(a.weekCalendar("option","use24Hour"),false);deepEqual(a.weekCalendar("option","firstDayOfWeek")(),0);deepEqual(a.weekCalendar("option","daysToShow"),7);deepEqual(a.weekCalendar("option","minBodyHeight"),100);deepEqual(a.weekCalendar("option","useShortDayNames"),false);deepEqual(a.weekCalendar("option","timeSeparator")," to ");deepEqual(a.weekCalendar("option","startParam"),"start");deepEqual(a.weekCalendar("option","endParam"),"end");deepEqual(a.weekCalendar("option","businessHours").start,8);deepEqual(a.weekCalendar("option","businessHours").end,18);deepEqual(a.weekCalendar("option","businessHours").limitDisplay,false);deepEqual(a.weekCalendar("option","newEventText"),"New Event");deepEqual(a.weekCalendar("option","timeslotHeight"),20);deepEqual(a.weekCalendar("option","defaultEventLength"),2);deepEqual(a.weekCalendar("option","timeslotsPerHour"),4);deepEqual(a.weekCalendar("option","minDate"),null);deepEqual(a.weekCalendar("option","maxDate"),null);deepEqual(a.weekCalendar("option","buttons"),true);deepEqual(a.weekCalendar("option","scrollToHourMillis"),500);deepEqual(a.weekCalendar("option","allowCalEventOverlap"),false);deepEqual(a.weekCalendar("option","overlapEventsSeparate"),false);deepEqual(a.weekCalendar("option","readonly"),false);deepEqual(a.weekCalendar("option","allowEventCreation"),true);deepEqual(a.weekCalendar("option","displayOddEven"),false);deepEqual(a.weekCalendar("option","textSize"),13);deepEqual(a.weekCalendar("option","headerSeparator"),"<br />");deepEqual(a.weekCalendar("option","getHeaderDate"),null);deepEqual(a.weekCalendar("option","preventDragOnEventCreation"),false);deepEqual(a.weekCalendar("option","draggable")(),true)});test("date parsing",function(){var d=$("#calendar");d.weekCalendar();expect(15);var c=$.proxy(d.data("weekCalendar"),"_cleanDate"),a,b=[{value:new Date("Fri Jul 16 2010 14:15:00"),expected:new Date("Fri Jul 16 2010 14:15:00").getTime()},{value:1276683300000,expected:1276683300000},{value:"1276683300000",expected:1276683300000},{value:"2010-06-16T12:15:00+02:00",expected:1276683300000},{value:"2010-06-16T12:15:00.000+02:00",expected:1276683300000},{value:"Wed Jun 16 2010 12:15:00 GMT+0200",expected:1276683300000},{value:"2010-06-16T12:15",expected:1276683300000}];ok($.isFunction(d.data("weekCalendar")._cleanDate),"check _cleanDate is a function");$(b).each(function(e,f){a=d.data("weekCalendar")._cleanDate(f.value);ok(a instanceof Date,"Case "+e+': "_cleanDate" returns a Date instance');equal(a.getTime(),f.expected,"Case "+e+": The returned date is correct.")})});test("Date internationalization",function(){var a=$("#calendar");a.weekCalendar({date:new Date("Apr 21 2011"),firstDayOfWeek:$.datepicker.regional.fr.firstDay,shortDays:$.datepicker.regional.fr.dayNamesShort,longDays:$.datepicker.regional.fr.dayNames,shortMonths:$.datepicker.regional.fr.monthNamesShort,longMonths:$.datepicker.regional.fr.monthNames,dateFormat:"d F y"});expect(53);deepEqual(a.weekCalendar("formatDate",new Date("Apr 20 2011 14:50:32 GMT+0200")),"20 Avril 11");deepEqual(a.weekCalendar("formatDate",new Date("Apr 20 2011 14:50:32 GMT+0200"),"l j M Y"),"Mercredi 20 Avril 2011");a.weekCalendar("option",{dateFormat:"d D j l N S w F m M n t Y y a A g G h H i s O P Z r U",firstDayOfWeek:$.datepicker.regional["en-GB"].firstDay,shortDays:$.datepicker.regional["en-GB"].dayNamesShort,longDays:$.datepicker.regional["en-GB"].dayNames,shortMonths:$.datepicker.regional["en-GB"].monthNamesShort,longMonths:$.datepicker.regional["en-GB"].monthNames});deepEqual(a.weekCalendar("formatDate",new Date("Apr 01 2011 14:50:32 GMT+0200")),"01 Fri 1 Friday 5 st 5 April 04 Apr 4 30 2011 11 pm PM 2 14 02 14 50 32 +0200 +02:00 7200 Fri, 01 Apr 2011 14:50:32 +0200 1301662232");deepEqual(a.weekCalendar("formatDate",new Date("Apr 01 2011 14:50:32 GMT+0200"),"d"),"01");deepEqual(a.weekCalendar("formatDate",new Date("Apr 10 2011 14:50:32 GMT+0200"),"d"),"10");deepEqual(a.weekCalendar("formatDate",new Date("Apr 01 2011 14:50:32 GMT+0200"),"j"),"1");deepEqual(a.weekCalendar("formatDate",new Date("Apr 01 2011 14:50:32 GMT+0200"),"D"),"Fri");deepEqual(a.weekCalendar("formatDate",new Date("Apr 01 2011 14:50:32 GMT+0200"),"l"),"Friday");deepEqual(a.weekCalendar("formatDate",new Date("Apr 18 2011 14:50:32 GMT+0200"),"N"),"1");deepEqual(a.weekCalendar("formatDate",new Date("Apr 19 2011 14:50:32 GMT+0200"),"N"),"2");deepEqual(a.weekCalendar("formatDate",new Date("Apr 20 2011 14:50:32 GMT+0200"),"N"),"3");deepEqual(a.weekCalendar("formatDate",new Date("Apr 21 2011 14:50:32 GMT+0200"),"N"),"4");deepEqual(a.weekCalendar("formatDate",new Date("Apr 22 2011 14:50:32 GMT+0200"),"N"),"5");deepEqual(a.weekCalendar("formatDate",new Date("Apr 23 2011 14:50:32 GMT+0200"),"N"),"6");deepEqual(a.weekCalendar("formatDate",new Date("Apr 24 2011 14:50:32 GMT+0200"),"N"),"7");deepEqual(a.weekCalendar("formatDate",new Date("Apr 01 2011 14:50:32 GMT+0200"),"S"),"st");deepEqual(a.weekCalendar("formatDate",new Date("Apr 18 2011 14:50:32 GMT+0200"),"w"),"1");deepEqual(a.weekCalendar("formatDate",new Date("Apr 19 2011 14:50:32 GMT+0200"),"w"),"2");deepEqual(a.weekCalendar("formatDate",new Date("Apr 20 2011 14:50:32 GMT+0200"),"w"),"3");deepEqual(a.weekCalendar("formatDate",new Date("Apr 21 2011 14:50:32 GMT+0200"),"w"),"4");deepEqual(a.weekCalendar("formatDate",new Date("Apr 22 2011 14:50:32 GMT+0200"),"w"),"5");deepEqual(a.weekCalendar("formatDate",new Date("Apr 23 2011 14:50:32 GMT+0200"),"w"),"6");deepEqual(a.weekCalendar("formatDate",new Date("Apr 24 2011 14:50:32 GMT+0200"),"w"),"0");deepEqual(a.weekCalendar("formatDate",new Date("Apr 01 2011 14:50:32 GMT+0200"),"F"),"April");deepEqual(a.weekCalendar("formatDate",new Date("Apr 01 2011 14:50:32 GMT+0200"),"m"),"04");deepEqual(a.weekCalendar("formatDate",new Date("Apr 01 2011 14:50:32 GMT+0200"),"M"),"Apr");deepEqual(a.weekCalendar("formatDate",new Date("Apr 01 2011 14:50:32 GMT+0200"),"n"),"4");deepEqual(a.weekCalendar("formatDate",new Date("Nov 01 2011 14:50:32 GMT+0200"),"n"),"11");deepEqual(a.weekCalendar("formatDate",new Date("Feb 01 2011 14:50:32 GMT+0200"),"t"),"28");deepEqual(a.weekCalendar("formatDate",new Date("Feb 01 1900 14:50:32 GMT+0200"),"t"),"28");deepEqual(a.weekCalendar("formatDate",new Date("Feb 01 2000 14:50:32 GMT+0200"),"t"),"29");deepEqual(a.weekCalendar("formatDate",new Date("Feb 01 2004 14:50:32 GMT+0200"),"t"),"29");deepEqual(a.weekCalendar("formatDate",new Date("Jun 01 2011 14:50:32 GMT+0200"),"t"),"30");deepEqual(a.weekCalendar("formatDate",new Date("May 01 2011 14:50:32 GMT+0200"),"t"),"31");deepEqual(a.weekCalendar("formatDate",new Date("Apr 01 2011 14:50:32 GMT+0200"),"Y"),"2011");deepEqual(a.weekCalendar("formatDate",new Date("Apr 01 2011 14:50:32 GMT+0200"),"y"),"11");deepEqual(a.weekCalendar("formatDate",new Date("Apr 01 2011 14:50:32 GMT+0200"),"a"),"pm");deepEqual(a.weekCalendar("formatDate",new Date("Apr 01 2011 11:50:32 GMT+0200"),"a"),"am");deepEqual(a.weekCalendar("formatDate",new Date("Apr 01 2011 14:50:32 GMT+0200"),"A"),"PM");deepEqual(a.weekCalendar("formatDate",new Date("Apr 01 2011 11:50:32 GMT+0200"),"A"),"AM");deepEqual(a.weekCalendar("formatDate",new Date("Apr 01 2011 14:50:32 GMT+0200"),"g"),"2");deepEqual(a.weekCalendar("formatDate",new Date("Apr 01 2011 14:50:32 GMT+0200"),"G"),"14");deepEqual(a.weekCalendar("formatDate",new Date("Apr 01 2011 00:50:32 GMT+0200"),"G"),"0");deepEqual(a.weekCalendar("formatDate",new Date("Apr 01 2011 14:50:32 GMT+0200"),"h"),"02");deepEqual(a.weekCalendar("formatDate",new Date("Apr 01 2011 14:50:32 GMT+0200"),"H"),"14");deepEqual(a.weekCalendar("formatDate",new Date("Apr 01 2011 00:50:32 GMT+0200"),"H"),"00");deepEqual(a.weekCalendar("formatDate",new Date("Apr 01 2011 14:00:32 GMT+0200"),"i"),"00");deepEqual(a.weekCalendar("formatDate",new Date("Apr 01 2011 14:00:32 GMT+0200"),"s"),"32");deepEqual(a.weekCalendar("formatDate",new Date("Apr 01 2011 14:00:32 GMT+0200"),"O"),"+0200");deepEqual(a.weekCalendar("formatDate",new Date("Apr 01 2011 14:00:32 GMT+0200"),"P"),"+02:00");deepEqual(a.weekCalendar("formatDate",new Date("Apr 01 2011 14:00:32 GMT+0200"),"Z"),"7200");deepEqual(a.weekCalendar("formatDate",new Date("Apr 01 2011 14:51:32 GMT+0200"),"r"),"Fri, 01 Apr 2011 14:51:32 +0200");deepEqual(a.weekCalendar("formatDate",new Date("Apr 01 2011 14:50:32 GMT+0200"),"U"),"1301662232")});test("issue # 60: eventHeader doesn't take care of use24Hour option",function(){var c=$("#calendar");c.weekCalendar({use24Hour:false,timeSeparator:" -> "});var b=formatTimeZone();expect(5);var d=[{id:1,start:"2009-05-10T13:15:00"+b,end:"2009-05-10T14:15:00"+b,title:"Lunch with Mike"},{id:1,start:"2009-05-10T10:15:00"+b,end:"2009-05-10T12:15:00"+b,title:"Lunch with Mike"}];var a=c.data("weekCalendar");d=a._cleanEvents.call(a,d);var e=c.weekCalendar("option","eventHeader");ok($.isFunction(e),"check eventHeader is a function");deepEqual(e(d[0],c),"01:15 pm -> 02:15 pm");deepEqual(e(d[1],c),"10:15 am -> 12:15 pm");c.weekCalendar("option","use24Hour",true);deepEqual(e(d[0],c),"13:15 -> 14:15");deepEqual(e(d[1],c),"10:15 -> 12:15")});test("issue #49: wrong calculation of DateLastMilliOfWeek",function(){var a=$("#calendar");a.weekCalendar({date:new Date("Apr 21 2011"),daysToShow:7,firstDayOfWeek:1,startOnFirstDayOfWeek:true});var i=formatTimeZone();expect(30);var e=[{id:1,start:"2009-05-10T13:15:00"+i,end:"2009-05-10T14:15:00"+i,title:"Lunch with Mike"},{id:1,start:"2009-05-10T10:15:00"+i,end:"2009-05-10T12:15:00"+i,title:"Lunch with Mike"}];var b=a.data("weekCalendar");ok($.isFunction(b._dateLastDayOfWeek),"check _dateLastDayOfWeek is a function");ok($.isFunction(b._dateFirstDayOfWeek),"check _dateFirstDayOfWeek is a function");ok($.isFunction(b._dateLastMilliOfWeek),"check _dateLastMilliOfWeek is a function");var f=function(){return b._dateLastDayOfWeek.apply(b,arguments)};var h=function(){return b._dateFirstDayOfWeek.apply(b,arguments)};var g=function(){return b._dateLastMilliOfWeek.apply(b,arguments)};var c,d;c=h(new Date("Apr 21 2011"));ok(c instanceof Date,"_dateFirstDayOfWeek returns a date");equals(c.toString(),(new Date("Apr 18 2011")).toString(),"_dateFirstDayOfWeek returns monday");c=f(new Date("Apr 21 2011"));ok(c instanceof Date,"_dateLastDayOfWeek returns a date");equals(c.toString(),(new Date("Apr 24 2011")).toString(),"_dateLastDayOfWeek returns sunday");c=g(new Date("Apr 21 2011"));ok(c instanceof Date,"_dateLastMilliOfWeek returns a date");equals(c.toString(),(new Date("Apr 25 2011 00:00:00")).toString(),"_dateLastMilliOfWeek returns next monday midnight");a.weekCalendar("option","firstDayOfWeek",0);c=h(new Date("Apr 21 2011"));equals(c.toString(),(new Date("Apr 17 2011")).toString(),"_dateFirstDayOfWeek returns sunday");c=f(new Date("Apr 21 2011"));equals(c.toString(),(new Date("Apr 23 2011")).toString(),"_dateLastDayOfWeek returns monday");c=g(new Date("Apr 21 2011"));equals(c.toString(),(new Date("Apr 24 2011 00:00:00")).toString(),"_dateLastMilliOfWeek returns next sunday midnight");c=h(new Date("Apr 01 2011"));equals(c.toString(),(new Date("Mar 27 2011")).toString(),"_dateFirstDayOfWeek returns sunday 27 Mar");c=f(new Date("Apr 01 2011"));equals(c.toString(),(new Date("Apr 2 2011")).toString(),"_dateLastDayOfWeek returns Sat 2 APr");c=g(new Date("Apr 01 2011"));equals(c.toString(),(new Date("Apr 03 2011 00:00:00")).toString(),"_dateLastMilliOfWeek returns next sunday midnight 3 Apr ");a.weekCalendar("option","firstDayOfWeek",1);c=h(new Date("Apr 30 2011"));equals(c.toString(),(new Date("Apr 25 2011")).toString(),"_dateFirstDayOfWeek returns monday 25");c=f(new Date("Apr 30 2011"));equals(c.toString(),(new Date("May 01 2011")).toString(),"_dateLastDayOfWeek returns Sun 1");c=g(new Date("Apr 30 2011"));equals(c.toString(),(new Date("May 02 2011 00:00:00")).toString(),"_dateLastMilliOfWeek returns next monday midnight 2");a.weekCalendar("option","firstDayOfWeek",0);c=h(new Date("Apr 23 2011"));equals(c.toString(),(new Date("Apr 17 2011")).toString(),"_dateFirstDayOfWeek returns sunday 17");c=f(new Date("Apr 23 2011"));equals(c.toString(),(new Date("Apr 23 2011")).toString(),"_dateLastDayOfWeek returns Saturday  23");c=g(new Date("Apr 23 2011"));equals(c.toString(),(new Date("Apr 24 2011 00:00:00")).toString(),"_dateLastMilliOfWeek returns next sunday midnight 24");c=h(new Date("Mar 01 2000"));equals(c.toString(),(new Date("Feb 27 2000")).toString(),"_dateFirstDayOfWeek returns sunday 27");c=f(new Date("Mar 01 2000"));equals(c.toString(),(new Date("Mar 04 2000")).toString(),"_dateLastDayOfWeek returns monday 4 ");c=g(new Date("Mar 01 2000"));equals(c.toString(),(new Date("Mar 05 2000 00:00:00")).toString(),"_dateLastMilliOfWeek returns next sunday midnight 5");a.weekCalendar("option","firstDayOfWeek",1);d=new Date("Mar 22 2011");c=h(d);equals(c.toString(),(new Date("Mar 21 2011")).toString(),"_dateFirstDayOfWeek returns monday 21");c=f(d);equals(c.toString(),(new Date("Mar 27 2011")).toString(),"_dateLastDayOfWeek returns sunday 27");c=g(d);equals(c.toString(),(new Date("Mar 28 2011 00:00:00")).toString(),"_dateLastMilliOfWeek returns next monday midnight 28");d=new Date("Oct 26 2011");c=h(d);equals(c.toString(),(new Date("Oct 24 2011")).toString(),"_dateFirstDayOfWeek returns monday 24");c=f(d);equals(c.toString(),(new Date("Oct 30 2011")).toString(),"_dateLastDayOfWeek returns sunday 30 ");c=g(d);equals(c.toString(),(new Date("Oct 31 2011 00:00:00")).toString(),"_dateLastMilliOfWeek returns next monday midnight 31")});